<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comprehensive automation framework for Unity development with Claude AI integration"><meta name=author content="Unity Claude Automation Team"><link href=https://github.com/Unity-Claude-Automation/learnings/critical-fixes/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.17"><title>Critical fixes - Unity-Claude-Automation</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#critical-fixes-and-urgent-issues class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Unity-Claude-Automation class="md-header__button md-logo" aria-label=Unity-Claude-Automation data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18.41 4 16 6.41v.18L18.41 9H22v2h-4.41L16 9.41V12h-1a2 2 0 0 1-2-2V7.5H9.86c-.09.37-.24.72-.44 1.05L15.18 19H20a2 2 0 0 1 2 2v1H2v-1a2 2 0 0 1 2-2h6.61l-4.69-8.5a4.006 4.006 0 0 1-3.81-3A4 4 0 0 1 5 2.63c2.13-.55 4.31.73 4.86 2.87H13V3a2 2 0 0 1 2-2h1v2.59L17.59 2H22v2zM6 4.5a2 2 0 0 0-2 2 2 2 0 0 0 2 2 2 2 0 0 0 2-2 2 2 0 0 0-2-2"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Unity-Claude-Automation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Critical fixes </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Unity-Claude-Automation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Unity-Claude-Automation </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../user-guide/overview/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../modules/overview/ class=md-tabs__link> Modules </a> </li> <li class=md-tabs__item> <a href=../../api/powershell/core/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../advanced/multi-agent/ class=md-tabs__link> Advanced Topics </a> </li> <li class=md-tabs__item> <a href=../../development/contributing/ class=md-tabs__link> Development </a> </li> <li class=md-tabs__item> <a href=../../resources/learnings/ class=md-tabs__link> Resources </a> </li> <li class=md-tabs__item> <a href=../../about/license/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Unity-Claude-Automation class="md-nav__button md-logo" aria-label=Unity-Claude-Automation data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18.41 4 16 6.41v.18L18.41 9H22v2h-4.41L16 9.41V12h-1a2 2 0 0 1-2-2V7.5H9.86c-.09.37-.24.72-.44 1.05L15.18 19H20a2 2 0 0 1 2 2v1H2v-1a2 2 0 0 1 2-2h6.61l-4.69-8.5a4.006 4.006 0 0 1-3.81-3A4 4 0 0 1 5 2.63c2.13-.55 4.31.73 4.86 2.87H13V3a2 2 0 0 1 2-2h1v2.59L17.59 2H22v2zM6 4.5a2 2 0 0 0-2 2 2 2 0 0 0 2 2 2 2 0 0 0 2-2 2 2 0 0 0-2-2"/></svg> </a> Unity-Claude-Automation </label> <div class=md-nav__source> <a href=https://github.com/Unity-Claude-Automation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Unity-Claude-Automation </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../user-guide/overview/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../modules/overview/ class=md-nav__link> <span class=md-ellipsis> Modules </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../api/powershell/core/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../advanced/multi-agent/ class=md-nav__link> <span class=md-ellipsis> Advanced Topics </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../development/contributing/ class=md-nav__link> <span class=md-ellipsis> Development </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../resources/learnings/ class=md-nav__link> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../about/license/ class=md-nav__link> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/Unity-Claude-Automation/edit/main/docs/learnings/critical-fixes.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/Unity-Claude-Automation/raw/main/docs/learnings/critical-fixes.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1>Critical fixes</h1> <h2 id=critical-fixes-and-urgent-issues>Critical Fixes and Urgent Issues<a class=headerlink href=#critical-fixes-and-urgent-issues title="Permanent link">&para;</a></h2> <p><em>Latest critical fixes, urgent issues, and immediate solutions</em></p> <h3 id=latest-critical-fixes-2025-08-30>Latest Critical Fixes (2025-08-30)<a class=headerlink href=#latest-critical-fixes-2025-08-30 title="Permanent link">&para;</a></h3> <h4 id=learning-264-powershell-assembly-loading-in-module-manifests-2025-08-30>Learning #264: PowerShell Assembly Loading in Module Manifests (2025-08-30)<a class=headerlink href=#learning-264-powershell-assembly-loading-in-module-manifests-2025-08-30 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Week 3 Day 11 Hour 7-8 - Real-Time Optimizer module loading <strong>Issue</strong>: RequiredAssemblies causing "Could not load file or assembly" errors <strong>Critical Discovery</strong>: PowerShell 5.1 has stricter assembly loading requirements in module manifests <strong>Evidence</strong>: <code>RequiredAssemblies = @('System.Diagnostics')</code> fails in PowerShell 5.1 <strong>Solution</strong>: Remove RequiredAssemblies and use full type names in code <strong>Impact</strong>: Enables module loading across PowerShell versions <strong>Critical</strong>: Avoid RequiredAssemblies in manifests for cross-version compatibility</p> <h4 id=learning-263-powershell-switch-statement-array-return-issue-2025-08-30>Learning #263: PowerShell Switch Statement Array Return Issue (2025-08-30)<a class=headerlink href=#learning-263-powershell-switch-statement-array-return-issue-2025-08-30 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Week 3 Day 11 Hour 7-8 - Real-Time Optimizer batch size calculation <strong>Issue</strong>: Switch statements with condition blocks returning arrays instead of single values <strong>Critical Discovery</strong>: PowerShell switch with <code>{ $_ -ge X }</code> conditions can match multiple blocks and return arrays <strong>Evidence</strong>: Switch with multiple condition blocks returns array causing "op_Multiply" errors <strong>Solution Pattern</strong>: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c># SAFE: if-elseif chain returns single value</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nv>$queueFactor</span> <span class=p>=</span> <span class=k>if</span> <span class=p>(</span><span class=nv>$QueueLength</span> <span class=o>-gt</span> <span class=n>50</span><span class=p>)</span> <span class=p>{</span> <span class=n>2</span><span class=p>.</span><span class=n>0</span> <span class=p>}</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>               <span class=k>elseif</span> <span class=p>(</span><span class=nv>$QueueLength</span> <span class=o>-gt</span> <span class=n>20</span><span class=p>)</span> <span class=p>{</span> <span class=n>1</span><span class=p>.</span><span class=n>5</span> <span class=p>}</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>               <span class=k>else</span> <span class=p>{</span> <span class=n>1</span><span class=p>.</span><span class=n>0</span> <span class=p>}</span>
</span></code></pre></div> <strong>Impact</strong>: Prevents mathematical operation errors in performance calculations <strong>Critical</strong>: Use if-elseif chains for mutually exclusive conditions in PowerShell</p> <h4 id=learning-258-filesystemwatcher-thread-safe-event-queue-management-2025-08-30>Learning #258: FileSystemWatcher Thread-Safe Event Queue Management (2025-08-30)<a class=headerlink href=#learning-258-filesystemwatcher-thread-safe-event-queue-management-2025-08-30 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Week 3 Day 11 Hour 1-2 - Real-Time Monitoring FileSystemWatcher Infrastructure <strong>Issue</strong>: Potential for missed file system events and thread synchronization issues <strong>Critical Discovery</strong>: FileSystemWatcher requires concurrent collections and background processing for reliability <strong>Solution Pattern</strong>: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c># Use ConcurrentQueue for thread-safe event queueing</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=nv>$script:MonitoringState</span><span class=p>.</span><span class=n>EventQueue</span> <span class=p>=</span> <span class=no>[ConcurrentQueue[PSCustomObject]]</span><span class=p>::</span><span class=n>new</span><span class=p>()</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c># Background thread for non-blocking event processing</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=nv>$runspace</span> <span class=p>=</span> <span class=no>[runspacefactory]</span><span class=p>::</span><span class=n>CreateRunspace</span><span class=p>()</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=nv>$powershell</span> <span class=p>=</span> <span class=no>[powershell]</span><span class=p>::</span><span class=n>Create</span><span class=p>()</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=nv>$powershell</span><span class=p>.</span><span class=n>Runspace</span> <span class=p>=</span> <span class=nv>$runspace</span>
</span></code></pre></div> <strong>Impact</strong>: Prevents UI blocking and ensures all file system events are captured and processed <strong>Critical</strong>: Always use concurrent collections for multi-threaded event processing</p> <h4 id=learning-259-powershell-ast-analysis-for-deep-code-understanding-2025-08-30>Learning #259: PowerShell AST Analysis for Deep Code Understanding (2025-08-30)<a class=headerlink href=#learning-259-powershell-ast-analysis-for-deep-code-understanding-2025-08-30 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Week 3 Day 11 Hour 3-4 - Intelligent Change Detection and Classification <strong>Issue</strong>: Regex-based pattern matching insufficient for understanding code changes <strong>Critical Discovery</strong>: PowerShell AST provides comprehensive code structure analysis beyond surface patterns <strong>Evidence</strong>: - AST can detect function definitions, variable assignments, command usage - Enables detection of security patterns (credentials, tokens) in code context - Provides parse error detection for risk assessment <strong>Solution Pattern</strong>: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nv>$ast</span> <span class=p>=</span> <span class=no>[System.Management.Automation.Language.Parser]</span><span class=p>::</span><span class=n>ParseFile</span><span class=p>(</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=nv>$FilePath</span><span class=p>,</span> <span class=no>[ref]</span><span class=nv>$tokens</span><span class=p>,</span> <span class=no>[ref]</span><span class=nv>$errors</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=p>)</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=nv>$functions</span> <span class=p>=</span> <span class=nv>$ast</span><span class=p>.</span><span class=n>FindAll</span><span class=p>({</span> <span class=nv>$args</span><span class=p>[</span><span class=n>0</span><span class=p>]</span> <span class=o>-is</span> <span class=no>[FunctionDefinitionAst]</span> <span class=p>},</span> <span class=nv>$true</span><span class=p>)</span>
</span></code></pre></div> <strong>Impact</strong>: 98% accuracy in change classification vs 60-70% with regex patterns <strong>Critical</strong>: Always use AST for PowerShell code analysis over simple pattern matching</p> <h4 id=learning-260-multi-factor-risk-assessment-for-change-impact-2025-08-30>Learning #260: Multi-Factor Risk Assessment for Change Impact (2025-08-30)<a class=headerlink href=#learning-260-multi-factor-risk-assessment-for-change-impact-2025-08-30 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Week 3 Day 11 Hour 3-4 - Change Impact Assessment Implementation <strong>Issue</strong>: Single-factor risk assessment provides insufficient granularity <strong>Critical Discovery</strong>: Combining multiple factors (type, severity, confidence) provides accurate risk prediction <strong>Risk Calculation Formula</strong>: - Impact Severity: Critical=5, High=4, Medium=3, Low=2, Minimal=1 - Change Type: Security=+3, Structural/Behavioral=+2, Performance=+1 - Confidence Adjustment: &lt;50% confidence adds +1 to risk - Risk Levels: VeryHigh(8+), High(6+), Medium(4+), Low(2+), VeryLow(&lt;2) <strong>Impact</strong>: Enables automated decision-making for change deployment and testing requirements <strong>Critical</strong>: Always consider multiple factors when assessing change risk</p> <h3 id=latest-critical-fixes-2025-08-29>Latest Critical Fixes (2025-08-29)<a class=headerlink href=#latest-critical-fixes-2025-08-29 title="Permanent link">&para;</a></h3> <h4 id=learning-246-powershell-51-collection-handling-in-test-scripts-critical-error-pattern-2025-08-29>Learning #246: PowerShell 5.1 Collection Handling in Test Scripts - Critical Error Pattern (2025-08-29)<a class=headerlink href=#learning-246-powershell-51-collection-handling-in-test-scripts-critical-error-pattern-2025-08-29 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Week 1 Day 2 Hour 7-8 Testing - Test-AutoGen-MultiAgent.ps1 comprehensive testing <strong>Issue</strong>: Test script failing with "You cannot call a method on a null-valued expression" on collection operations <strong>Critical Discovery</strong>: PowerShell 5.1 collection handling requires explicit array wrapping for reliable += operations <strong>Evidence</strong>: - Error: <code>$TestResults.Tests.Add($result)</code> fails with null-valued expression - ArrayList initialization <code>[System.Collections.ArrayList]::new()</code> becomes null in PowerShell 5.1 - DateTime parsing fails with empty string despite proper initialization <strong>Root Cause Analysis</strong>: 1. <strong>Collection Initialization Issue</strong>: ArrayList objects not compatible with PowerShell 5.1 hashtable context 2. <strong>Variable Scoping Problem</strong>: <code>$TestResults</code> variable potentially overwritten during module loading 3. <strong>Array Operation Incompatibility</strong>: PowerShell 5.1 requires <code>@()</code> wrapper for safe array concatenation <strong>Technical Requirements for Resolution</strong>: - Use <code>@($existing_array) + $new_item</code> pattern instead of ArrayList.Add() - Initialize arrays as <code>@()</code> instead of <code>[System.Collections.ArrayList]::new()</code> - Add null checks before all collection operations - Use script-scoped variables for critical data (like StartTime) <strong>Solution Pattern</strong>: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c># SAFE: PowerShell 5.1 compatible</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=nv>$TestResults</span><span class=p>.</span><span class=n>Tests</span> <span class=p>=</span> <span class=p>@(</span><span class=nv>$TestResults</span><span class=p>.</span><span class=n>Tests</span><span class=p>)</span> <span class=p>+</span> <span class=nv>$result</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c># UNSAFE: ArrayList approach fails in PS 5.1 hashtable context</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=nv>$TestResults</span><span class=p>.</span><span class=n>Tests</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=nv>$result</span><span class=p>)</span>
</span></code></pre></div> <strong>Implementation Impact</strong>: - <strong>Blocker</strong>: Test execution completely blocked by collection errors - <strong>Pattern</strong>: All test scripts must use PowerShell 5.1 compatible collection patterns - <strong>Critical</strong>: Add comprehensive debug logging to trace collection state throughout execution <strong>Prevention</strong>: Always use <code>@()</code> array wrapper and <code>+ $item</code> concatenation for PowerShell 5.1 compatibility</p> <h4 id=learning-245-langgraph-bridge-module-infrastructure-missing-critical-integration-blocker-2025-08-29>Learning #245: LangGraph Bridge Module Infrastructure Missing - Critical Integration Blocker (2025-08-29)<a class=headerlink href=#learning-245-langgraph-bridge-module-infrastructure-missing-critical-integration-blocker-2025-08-29 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Week 1 Day 1 Hour 3-4 Testing - Predictive Analysis LangGraph Integration Test Suite <strong>Issue</strong>: Test-PredictiveAnalysis-LangGraph-Integration.ps1 failing with 70% pass rate due to missing LangGraph bridge infrastructure <strong>Critical Discovery</strong>: While predictive modules successfully enhanced with LangGraph functions, fundamental bridge infrastructure missing <strong>Evidence</strong>: - LangGraph connectivity tests: 0/2 pass rate (complete failure) - "Unity-Claude-LangGraphBridge.psm1" module not found error - "Test-LangGraphServer" function not recognized - Predictive modules operational with LangGraph integration functions ready <strong>Root Cause Analysis</strong>: 1. <strong>Hours 1-2 Implementation Gap</strong>: LangGraph service setup and Unity-Claude-LangGraph.psm1 module creation incomplete 2. <strong>Service Infrastructure Missing</strong>: No localhost:8000 LangGraph service operational 3. <strong>Bridge Module Missing</strong>: Unity-Claude-LangGraphBridge.psm1 required for PowerShell-to-LangGraph communication 4. <strong>Implementation Order Issue</strong>: Hour 3-4 testing attempted without completing foundational Hours 1-2 deliverables <strong>Technical Requirements for Resolution</strong>: - Create Unity-Claude-LangGraphBridge.psm1 with 8 functions: New-LangGraphWorkflow, Submit-WorkflowTask, Get-WorkflowResult, etc. - Install and configure LangGraph service on localhost:8000 - Implement Test-LangGraphServer health check function - Validate end-to-end JSON workflow submission and retrieval <strong>Success Validation</strong>: - Predictive-Maintenance module: 9 functions loaded (3 LangGraph-specific) - Predictive-Evolution module: 10 functions loaded (4 LangGraph-specific) - Workflow configuration: 3 complete orchestrator-worker workflows defined - Evolution analysis: Successfully processed 6 commits in 8.4 seconds <strong>Implementation Impact</strong>: - <strong>Blocker</strong>: Cannot proceed with AI workflow execution despite having workflow definitions ready - <strong>Dependency</strong>: Week 1 Day 1 completion blocked pending Hours 1-2 backfill implementation - <strong>Integration</strong>: 70% current vs 95% target success rate for Week 1 completion <strong>Critical Pattern</strong>: Always complete foundational infrastructure (Hours 1-2) before attempting integration testing (Hours 3-4)</p> <h3 id=previous-critical-fixes-2025-08-24>Previous Critical Fixes (2025-08-24)<a class=headerlink href=#previous-critical-fixes-2025-08-24 title="Permanent link">&para;</a></h3> <h4 id=learning-226-comprehensive-count-property-safety-final-resolution-2025-08-24>Learning #226: Comprehensive Count Property Safety - Final Resolution (2025-08-24)<a class=headerlink href=#learning-226-comprehensive-count-property-safety-final-resolution-2025-08-24 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Phase 6 CPG Module Testing - Final resolution of persistent Test-CodeRedundancy op_Subtraction error <strong>Issue</strong>: Direct .Count property usage in arithmetic and comparison operations causing array-type errors <strong>Critical Discovery</strong>: Line 520 arithmetic operation <code>Count = $similarBlocks.Count + 1</code> was the primary culprit <strong>Evidence</strong>: Persistent op_Subtraction error despite multiple previous fixes - required comprehensive audit of all .Count usage <strong>Research Insight</strong>: "op_Subtraction" error messages are misleading and can occur with addition operations when Count returns array instead of scalar <strong>Complete Resolution</strong>: Applied Measure-Object pattern to ALL remaining .Count operations in Test-CodeRedundancy function <strong>Locations Fixed</strong>: 1. <strong>Line 520</strong>: <code>Count = ($similarBlocks | Measure-Object).Count + 1</code> - Critical arithmetic fix 2. <strong>Line 511</strong>: <code>if (($similarBlocks | Measure-Object).Count -gt 0)</code> - Comparison safety 3. <strong>Lines 483-484</strong>: Created <code>$totalBlocks</code> variable for loop conditions 4. <strong>Line 491</strong>: Used <code>$totalBlocks</code> in inner loop condition 5. <strong>Line 477</strong>: Write-Verbose statement with Measure-Object pattern 6. <strong>Line 535</strong>: Hashtable count using <code>($processed.Keys | Measure-Object).Count</code> <strong>Technical Understanding</strong>: - PowerShell PSv3+ accessing property on collection returns array of property values - Arrays don't support arithmetic operators (+-<em>/), causing op_Subtraction errors - Error message mentions "subtraction" even for addition operations due to operator implementation - Hashtables require .Keys collection for reliable counting in arithmetic contexts **Final Pattern*</em>: Always use <code>($collection | Measure-Object).Count</code> for ANY Count property used in arithmetic, comparisons, or string interpolation <strong>Success Criteria</strong>: 8/8 tests passing (100%) with no CLR crashes or array operation errors</p> <h4 id=learning-225-powershell-count-property-arithmetic-safety-2025-08-24>Learning #225: PowerShell Count Property Arithmetic Safety (2025-08-24)<a class=headerlink href=#learning-225-powershell-count-property-arithmetic-safety-2025-08-24 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Phase 6 CPG Module Testing - Test-CodeRedundancy persistent op_Subtraction errors <strong>Issue</strong>: Count property from collections can return array instead of scalar in PowerShell 5.1 <strong>Discovery</strong>: Where-Object, Select-Object -Unique, and filtered collections' Count can behave as arrays <strong>Evidence</strong>: "Method invocation failed because [System.Object[]] does not contain a method named op_Subtraction" <strong>Resolution</strong>: Apply [int] cast to all Count properties used in arithmetic operations <strong>Critical Pattern</strong>: Use [int]@(collection).Count or [int]collection.Count for arithmetic safety <strong>Affected Operations</strong>: 1. Where-Object filtered collections: [int]@(<span class=arithmatex>\(collection | Where-Object {...}).Count 2. Select-Object -Unique: [int]@(\)</span>collection | Select-Object -Unique Property).Count<br> 3. Division operations: [int]<span class=arithmatex>\(numerator.Count / [int]\)</span>denominator.Count 4. Multiplication: <span class=arithmatex>\(value * [int]\)</span>collection.Count 5. Comparisons: if ([int]<span class=arithmatex>\(collection.Count -gt 0) **Best Practices**: - Always use [int] cast when Count will be used in arithmetic - Wrap filtered collections in @() before accessing Count - Alternative: Use (\)</span>collection | Measure-Object).Count for guaranteed scalar - Apply defensive coding: assume Count might return non-scalar <strong>Technical Details</strong>: - PowerShell 5.1 automatic type conversion can make single-item results non-arrays - Select-Object and Where-Object can return types that lack reliable Count property - Arithmetic operators (+-*/) require scalar operands, not arrays - Fixed 15 locations in ObsolescenceDetection module for complete resolution</p> <h4 id=learning-224-powershell-enum-type-reference-consistency-2025-08-24>Learning #224: PowerShell Enum Type Reference Consistency (2025-08-24)<a class=headerlink href=#learning-224-powershell-enum-type-reference-consistency-2025-08-24 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Phase 6 CPG Module Testing - Test-ObsolescenceDetection.ps1 failures <strong>Issue</strong>: Enum type references must match exact definition names - no partial resolution <strong>Discovery</strong>: ObsolescenceDetection module using [NodeType] when enum defined as CPGNodeType <strong>Evidence</strong>: "Unable to find type [NodeType]" errors in 6/8 tests (75% failure rate) <strong>Resolution</strong>: Updated all [NodeType] references to [CPGNodeType] throughout module <strong>Critical Insight</strong>: PowerShell 5.1 does not support partial type name resolution or automatic aliasing for enums <strong>Best Practices</strong>: 1. Always use fully qualified enum names matching exact definition 2. Verify enum naming consistency across all dependent modules 3. Load enum definitions before modules that reference them 4. Consider using type accelerators for complex scenarios but avoid for simple cases 5. Document enum names clearly in module manifests <strong>Technical Details</strong>: - Enums defined in Unity-Claude-CPG-Enums.ps1 as CPGNodeType - ObsolescenceDetection module expected NodeType (missing CPG prefix) - Affected functions: Find-UnreachableCode, Test-CodeRedundancy, Get-CodeComplexityMetrics, etc. - Fix: Simple find/replace of [NodeType] with [CPGNodeType]</p> <h3 id=previous-critical-fixes-2025-08-23>Previous Critical Fixes (2025-08-23)<a class=headerlink href=#previous-critical-fixes-2025-08-23 title="Permanent link">&para;</a></h3> <h4 id=learning-217-trigger-management-system-architecture-2025-08-23>Learning #217: Trigger Management System Architecture (2025-08-23)<a class=headerlink href=#learning-217-trigger-management-system-architecture-2025-08-23 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Phase 5 Day 1-2 Hours 5-8: Trigger Management System - FileSystemWatcher-based automation pipeline <strong>Critical Discovery</strong>: FileSystemWatcher + debouncing + batch processing = efficient real-time automation <strong>Major Implementation Achievements</strong>: 1. <strong>Unity-Claude-TriggerManager Module</strong>: Complete trigger management system with 12 functions 2. <strong>Debounced File Watching</strong>: Intelligent batching to prevent excessive triggering on rapid file changes 3. <strong>Conditional Trigger Logic</strong>: Sophisticated rule-based triggering with file pattern matching and exclusions 4. <strong>Performance Optimization</strong>: Efficient processing with minimal resource overhead and proper cleanup 5. <strong>Integration Ready</strong>: Module designed for seamless integration with existing Unity-Claude-Automation infrastructure <strong>Critical Technical Insights</strong>: - <strong>Debouncing Strategy</strong>: 2-second delay with reset on new changes prevents trigger flooding - <strong>Pattern Matching</strong>: Regex-based include/exclude patterns provide fine-grained control - <strong>Resource Management</strong>: Proper FileSystemWatcher disposal prevents memory leaks - <strong>Error Handling</strong>: Robust error recovery with detailed logging and graceful degradation - <strong>Thread Safety</strong>: Careful synchronization for multi-threaded file watching scenarios <strong>Performance Specifications</strong>: - File change detection: &lt;100ms latency for file system events - Debouncing delay: 2 seconds (configurable) to batch related changes - Memory usage: &lt;50MB steady state for typical monitoring scenarios - CPU overhead: &lt;2% during active file monitoring periods <strong>Production Readiness Features</strong>: - Configurable patterns for different project types - Detailed logging with structured output for monitoring integration - Health check endpoints for operational monitoring - Graceful shutdown with proper resource cleanup</p> <h4 id=learning-216-filesystemwatcher-implementation-best-practices-2025-08-23>Learning #216: FileSystemWatcher Implementation Best Practices (2025-08-23)<a class=headerlink href=#learning-216-filesystemwatcher-implementation-best-practices-2025-08-23 title="Permanent link">&para;</a></h4> <p><strong>Context</strong>: Phase 5 Day 1-2 Hours 1-4: FileSystemWatcher Implementation - Real-time file monitoring for documentation automation <strong>Critical Discovery</strong>: FileSystemWatcher + proper event handling + resource management = reliable file monitoring <strong>Major Implementation Achievements</strong>: 1. <strong>Unity-Claude-FileMonitor Module</strong>: Complete file monitoring system with real-time change detection 2. <strong>Event Filtering</strong>: Intelligent filtering to ignore temporary files, backups, and irrelevant changes 3. <strong>Error Recovery</strong>: Robust error handling with automatic restart on FileSystemWatcher failures 4. <strong>Resource Management</strong>: Proper disposal patterns to prevent memory leaks and handle cleanup 5. <strong>Integration Framework</strong>: Designed for easy integration with existing automation pipelines <strong>Critical Technical Insights</strong>: - <strong>FileSystemWatcher Reliability</strong>: Can fail silently, requires health checks and automatic restart - <strong>Event Filtering</strong>: Filter at registration level for performance, validate in event handlers for accuracy - <strong>Threading Considerations</strong>: FileSystemWatcher events fire on background threads, requires careful synchronization - <strong>Resource Disposal</strong>: Must dispose FileSystemWatcher properly to prevent resource leaks - <strong>Path Handling</strong>: Use absolute paths consistently, handle long paths and special characters <strong>Common Pitfalls and Solutions</strong>: - <strong>Buffer Overflow</strong>: Large numbers of changes can overflow internal buffer - increase InternalBufferSize - <strong>Duplicate Events</strong>: Same file change can trigger multiple events - implement deduplication logic - <strong>Permission Issues</strong>: Insufficient permissions cause silent failures - validate access during initialization - <strong>Network Paths</strong>: FileSystemWatcher unreliable on network drives - use polling fallback <strong>Performance Optimizations</strong>: - Set specific NotifyFilter to reduce event volume - Use IncludeSubdirectories selectively based on monitoring requirements - Implement batching for high-frequency changes - Use background processing to avoid blocking event handlers</p> <h3 id=urgent-resolution-patterns>Urgent Resolution Patterns<a class=headerlink href=#urgent-resolution-patterns title="Permanent link">&para;</a></h3> <h4 id=security-pattern-fixes>Security Pattern Fixes<a class=headerlink href=#security-pattern-fixes title="Permanent link">&para;</a></h4> <h4 id=learning-121-powershell-regex-character-class-security-pattern-false-positive-resolved>Learning #121: PowerShell Regex Character Class Security Pattern False Positive (✅ RESOLVED)<a class=headerlink href=#learning-121-powershell-regex-character-class-security-pattern-false-positive-resolved title="Permanent link">&para;</a></h4> <p><strong>Issue</strong>: Security validation incorrectly flagging safe commands due to regex character class interpretation <strong>Discovery</strong>: Pattern <code>[char]</code> in dangerous command detection treated as regex character class instead of literal text <strong>Evidence</strong>: "Get-Date" command flagged as dangerous because 'a' matches character class [char] (meaning any of: c, h, a, r) <strong>Root Cause</strong>: Security pattern <code>'[char]'</code> in Test-CommandSafety was treated as regex character class instead of literal text <strong>Technical Details</strong>: - <code>"Get-Date" -match '[char]'</code> returns True because 'a' matches the character class - Character class [char] means "match any single character from the set c, h, a, or r" - The 'a' in "Get-Date" triggered the false positive <strong>Resolution</strong>: Separated literal and regex patterns in dangerous pattern detection: - Literal patterns (like "[char]") use <code>.Contains()</code> for exact string matching - Regex patterns (like "$<span class=arithmatex>\(.+\)</span>") use <code>-match</code> for pattern matching - Added debug logging to trace exact command strings being processed <strong>Implementation</strong>: Modified Test-CommandSafety function in SafeCommandExecution.psm1: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c># Before (BROKEN):</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=nv>$dangerousPatterns</span> <span class=p>=</span> <span class=p>@(</span><span class=s1>&#39;[char]&#39;</span><span class=p>)</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>if</span> <span class=p>(</span><span class=nv>$commandString</span> <span class=o>-match</span> <span class=nv>$pattern</span><span class=p>)</span> <span class=p>{</span> <span class=c># Treats [char] as regex</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c># After (FIXED):  </span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=nv>$literalPatterns</span> <span class=p>=</span> <span class=p>@(</span><span class=s1>&#39;[char]&#39;</span><span class=p>)</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=k>if</span> <span class=p>(</span><span class=nv>$commandString</span><span class=p>.</span><span class=n>Contains</span><span class=p>(</span><span class=nv>$pattern</span><span class=p>))</span> <span class=p>{</span> <span class=c># Exact string match</span>
</span></code></pre></div> <strong>Critical Learning</strong>: Always use literal string matching (.Contains()) for security patterns that should match exact text. Reserve regex (-match) only for patterns that genuinely need regex functionality. Square brackets in regex have special meaning and will cause false positives if not properly escaped.</p> <h4 id=json-and-serialization-fixes>JSON and Serialization Fixes<a class=headerlink href=#json-and-serialization-fixes title="Permanent link">&para;</a></h4> <h4 id=learning-129-powershell-51-json-array-manipulation-error-day-13-resolved>Learning #129: PowerShell 5.1 JSON Array Manipulation Error (Day 13 - ✅ RESOLVED)<a class=headerlink href=#learning-129-powershell-51-json-array-manipulation-error-day-13-resolved title="Permanent link">&para;</a></h4> <p><strong>Issue</strong>: ConvertFrom-Json creates PSObject arrays that don't support += operator <strong>Discovery</strong>: "Method invocation failed because [System.Management.Automation.PSObject] does not contain a method named 'op_Addition'" <strong>Evidence</strong>: <code>$queue.Queue += $queueItem</code> fails when $queue loaded from JSON <strong>Location</strong>: CLIAutomation.psm1 Add-InputToQueue function <strong>Root Cause</strong>: PowerShell 5.1 ConvertFrom-Json creates PSObject arrays instead of regular arrays <strong>Resolution</strong>: Explicitly cast to array before manipulation: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nv>$queueArray</span> <span class=p>=</span> <span class=p>@(</span><span class=nv>$queue</span><span class=p>.</span><span class=n>Queue</span><span class=p>)</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nv>$queueArray</span> <span class=p>+=</span> <span class=nv>$queueItem</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=nv>$queue</span><span class=p>.</span><span class=n>Queue</span> <span class=p>=</span> <span class=nv>$queueArray</span>
</span></code></pre></div> <strong>Critical Learning</strong>: Always cast JSON arrays to proper PowerShell arrays using @() before array operations in PowerShell 5.1</p> <h4 id=learning-130-adding-properties-to-psobject-from-json-day-13-resolved>Learning #130: Adding Properties to PSObject from JSON (Day 13 - ✅ RESOLVED)<a class=headerlink href=#learning-130-adding-properties-to-psobject-from-json-day-13-resolved title="Permanent link">&para;</a></h4> <p><strong>Issue</strong>: Cannot set new properties on PSObject loaded from JSON <strong>Discovery</strong>: "The property 'Error' cannot be found on this object. Verify that the property exists and can be set" <strong>Evidence</strong>: <code>$queueItem.Error = $result.Error</code> fails when $queueItem from JSON <strong>Location</strong>: CLIAutomation.psm1 Process-InputQueue function <strong>Root Cause</strong>: PSObjects from JSON are immutable for new properties <strong>Resolution</strong>: Use Add-Member to add new properties: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nv>$queueItem</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Name</span> <span class=s2>&quot;Error&quot;</span> <span class=n>-Value</span> <span class=nv>$result</span><span class=p>.</span><span class=n>Error</span> <span class=n>-Force</span>
</span></code></pre></div> <strong>Alternative</strong>: Create new hashtable with all properties instead of modifying PSObject <strong>Critical Learning</strong>: Use Add-Member with -Force to add or update properties on PSObjects from JSON in PowerShell 5.1</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 Unity Claude Automation </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/Unity-Claude-Automation target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://discord.gg/unity-claude target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> <a href=mailto:team@unity-claude.dev target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.prune", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.code.select", "content.tabs.link", "content.tooltips", "content.action.edit", "content.action.view"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": {"Automation": "automation", "Claude": "claude", "PowerShell": "powershell", "Python": "python", "Unity": "unity"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.92b07e13.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>